import{r as P,c as s,o as e,d as y,N as R,w as p,j as v,m as F,F as g,_ as U,k as H,g as w,p as W,a as h,t as _,b as X,h as r,i as x,u as E,e as $}from"./Navigation-Dx91ZCbe.js";import{M as q,c as z,a as J}from"./MediaGrid-Ds-70f9x.js";import{m as M,a as N,f as K,i as Q}from"./axios_config-BOxkkDfg.js";import{E as Y}from"./EventGroupTable-CqM0FhzH.js";import{T as f}from"./ToggleShow-BPFzjegt.js";import{B as Z}from"./BarChart-DnUCAeyz.js";const ee={__name:"App",setup(T){return(l,t)=>{const i=P("router-view");return e(),s(g,null,[y(R),y(i,null,{default:p(({Component:k})=>[(e(),v(F(k)))]),_:1})],64)}}},te={key:0},ae={key:1},se={key:0,class:"header"},ne={key:1},oe={key:0,class:"status-message"},re={key:1,class:"status-message"},le={key:2},ie={key:0},ue=["innerHTML"],ce={key:0},de={class:"ed-links"},_e=["innerHTML"],pe={__name:"EventGroupDetail",props:{db_path:String},setup(T){const l=T,t=H(null),i=H("loading");async function k(){K({url:[N].concat(m.value).concat(["event_group.json"]).join("/"),axiosInstance:Q,on_start:()=>{t.value={},i.value="loading"},on_success:o=>{if(!o.hasOwnProperty("aliases"))throw new Error("Invalid data format: 'aliases' property missing");t.value=o,i.value="loaded"},on_error:o=>{i.value="error"}})}const A=w(()=>!t.value||!t.value.hasOwnProperty("media")?[]:t.value.media),m=w(()=>l.db_path?l.db_path.split("/").filter(Boolean):[]),O=w(()=>{var u;const o=(u=t.value)==null?void 0:u.events;return o?Object.keys(o).map(c=>{const a=o[c]||{},b=(a==null?void 0:a.dates)??(a==null?void 0:a.date)??(a==null?void 0:a.date_string)??(a==null?void 0:a.datetime)??"";return{value:(a==null?void 0:a.circle_count)??0,name:String(c),prefix:String(b),url:["/dea/event_detail/#"].concat(m.value||[]).concat([c]).join("/")}}):[]});return W(async()=>{m.value&&(console.log("Url change detected, now fetching new event data..."),l.db_path&&await k())}),(o,u)=>{var c,a,b,B,C,D;return e(),s(g,null,[h("head",null,[(c=t.value)!=null&&c.aliases?(e(),s("title",te,`\r
      dea | Event Group Detail\r
      `+_(" - "+((b=(a=t.value)==null?void 0:a.aliases)==null?void 0:b.join(" / ")))+`\r
    `,1)):(e(),s("title",ae,"dea | Event Group Detail"))]),u[1]||(u[1]=h("div",{class:"header-title"},"Event group detail",-1)),l.db_path?(e(),s("div",ne,[i.value=="loading"?(e(),s("div",oe," Loading database "+_(l.db_path)+"... ",1)):i.value=="error"?(e(),s("div",re,[u[0]||(u[0]=X(" Failed to fetch event group data. ")),h("button",{class:"retry-button",onClick:k,title:"Retry fetching event group data."}," Retry ")])):(e(),s("div",le,[y(Y,{event_group_db:t.value,eg_ar_path:m.value,show_details:!0},null,8,["event_group_db","eg_ar_path"]),(B=t.value)!=null&&B.sources?(e(),v(f,{key:0,class:"ts-sources",button_text:"Sources"},{default:p(()=>[(e(!0),s(g,null,x(t.value.sources,(n,d)=>(e(),s("p",{key:d},[n.type?(e(),s("span",ie,"("+_(n.type[0])+", "+_(n.type[1])+") ",1)):r("",!0),n!=null&&n.source?(e(),s("span",{key:1,innerHTML:E(M)(n.source)},null,8,ue)):r("",!0)]))),128))]),_:1})):r("",!0),t.value?(e(),v(f,{key:1,class:"ts-sources",button_text:"Links"},{default:p(()=>{var n,d,L,j;return[!((n=t.value)!=null&&n.links)||Array.isArray((d=t.value)==null?void 0:d.links)&((L=t.value)==null?void 0:L.links)==0?(e(),s("div",ce," (None) ")):r("",!0),h("div",de,[(e(!0),s(g,null,x((j=t.value)==null?void 0:j.links,(V,I)=>(e(),s("div",{key:I},[h("span",{innerHTML:E(M)(V)},null,8,_e)]))),128))])]}),_:1})):r("",!0),t.value?(e(),v(f,{key:2,class:"ts-sources",button_text:"Media"},{default:p(()=>[y(q,{media_list:A.value,media_folder_path:[E(N)].concat(m.value).concat(["media"]).join("/")},null,8,["media_list","media_folder_path"])]),_:1})):r("",!0),(C=t.value)!=null&&C.comments?(e(),v(f,{key:3,class:"ts-comments",button_text:"Comments"},{default:p(()=>[(e(!0),s(g,null,x(t.value.comments.split(`
`),(n,d)=>(e(),s("p",{key:d},_(n),1))),128))]),_:1})):r("",!0),(D=t.value)!=null&&D.events?(e(),v(f,{key:4,class:"ts-sources",button_text:"Stats"},{default:p(()=>[y(Z,{data:O.value,title:"Event participation"},null,8,["data"])]),_:1})):r("",!0)]))])):(e(),s("div",se,' Invalid database to fetch: "'+_(l.db_path)+'" ',1))],64)}}},S=U(pe,[["__scopeId","data-v-19405577"]]),ve=[{path:"/",component:S},{path:"/:db_path(.*)",component:S,props:!0}],me=z({history:J("/dea/event_group_detail/"),routes:ve}),G=$(ee);G.use(me);G.mount("#app");
